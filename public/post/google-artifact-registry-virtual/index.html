<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
    <title>Google Artifact Registry Remote Repositories Â· breadNET</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <link rel="stylesheet" href="http://localhost:1313/style.main.min.b98e12e6b4acb157747422458845caf0880e6eda788e2e2ee3ecc617a0e9bfc3.css" />

</head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
    <div class="site-nav-left">
        
        <a class="site-nav-logo" href="http://localhost:1313/">breadNET</a>
        

        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem">
                    <a href="/">HOME</a>
                </li>
                
                <li class="nav-home" role="menuitem">
                    <a href="/my-setup">MY SETUP</a>
                </li>
                
                <li class="nav-home" role="menuitem">
                    <a href="/story">THE STORY</a>
                </li>
                
            </ul>

            
            <span class="nav-post-title dash">Google Artifact Registry Remote Repositories</span>
            
        </div>
    </div>

    <div class="site-nav-right">
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem">
                    <a href="https://www.linkedin.com/in/bradley-stannard/">Linkedin</a>
                </li>
                
                <li class="nav-home" role="menuitem">
                    <a href="https://documentation.breadnet.co.uk/?mtm_campaign=breadnet&amp;mtm_kwd=navbar">Documentation</a>
                </li>
                
                <li class="nav-home" role="menuitem">
                    <a href="mailto:webmaster@breadnet.co.uk">Contact</a>
                </li>
                
                <li class="nav-home" role="menuitem">
                    <a href="https://github.com/userbradley">GitHub</a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>
</div>
</div><script>
        document.addEventListener('DOMContentLoaded', function () {
            if (window.Casper && window.Casper.stickyNavTitle) {
                window.Casper.stickyNavTitle({
                    navSelector: '.site-nav-main',
                    titleSelector: '.post-full-title',
                    activeClass: 'nav-post-title-active'
                });
            }
        });
    </script>
</header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post  no-image ">

            <header class="post-full-header">

                

                <h1 class="post-full-title">Google Artifact Registry Remote Repositories</h1>

                
                    <p class="post-full-custom-excerpt">What is the Google Artifact Registry remote repo and how do I use it?</p>
                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">

                        

                        <section class="post-full-byline-meta">
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2023-127-07">16 July 2023</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 3 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            

            <section class="post-full-content">
                <div class="post-content">
                    <p>Google Cloud in April <a href="https://cloud.google.com/blog/products/identity-security/take-control-your-supply-chain-artifact-registry">created a blog post</a> about a new part of the Artifact regsitry called <code>Remote Repositories</code></p>
<p>In todays installment, we will look at what they are, why you&rsquo;d use one, and how to integrate it with your daily workflow.</p>
<h2 id="what-is-artifact-registry">What is Artifact Registry</h2>
<p>Artifact Registry is the better version of Google Container Registry (gcr.io) which is a place for storing your OCI images. Artifact Registry has more features over <a href="https://cloud.google.com/artifact-registry/docs/transition/transition-from-gcr">the now deprecated Google Container Registry</a></p>
<p>They are, but not limited to:</p>
<ul>
<li>Storing Helm charts</li>
<li>Storing APT packages</li>
<li>Storing go and python packages</li>
<li>Remote repos (this blog post covers this)</li>
<li>Maven</li>
<li>KubeFlow Pipelines</li>
<li>Global storage or Regional</li>
<li>Security Scanning of images</li>
</ul>
<p>Unlike the old Google Container Registry, Artifact Registry has a nicer naming schema, making it easier to tell where the images are coming from</p>
<pre><code>LOCATION-docker.pkg.dev/PROJECT-ID/REPOSITORY/IMAGE:TAG
</code></pre>
<hr>
<h2 id="what-is-a-remote-repository">What is a remote Repository</h2>
<p>Google defines this as <code>A repository that acts as a caching proxy for External public artifact repository</code> - which in this case, is currently only Dockehub.</p>
<p>In human readable terms, this special repository allows you to have cached images in your google account, that are then delivered at line speed (internal traffic) to GKE clusters, cloud run or anything else. You can also use them on your laptop</p>
<h2 id="how-to-create-one">How to create one</h2>
<p>You are able to create a virtual Repository through the UI by navigating to the Artifact Registry and clicking <code>+ CREATE REPOSITORY</code></p>
<p>Select <code>Remote</code>
<img src="__GHOST_URL__/content/images/2023/07/image.png" alt="">
Alternativly, if you prefer terraform</p>
<pre><code>resource &quot;google_artifact_registry_repository&quot; &quot;containers&quot; {
  location      = var.region
  repository_id = &quot;breadnet-cache&quot;
  description   = &quot;breadNET Public Image cache&quot;
  format        = &quot;DOCKER&quot;
  mode          = &quot;REMOTE_REPOSITORY&quot;
  project       = var.project
  remote_repository_config {
    description = &quot;docker hub&quot;
    docker_repository {
      public_repository = &quot;DOCKER_HUB&quot;
    }
  }
}
</code></pre>
<h2 id="how-to-actually-use-it">How to actually use it</h2>
<p>Once you have the repository created, you will need to authenticate your local <a href="__GHOST_URL__/docker-its-over-moving-to-podman/">podman (or docker)</a> to the Artifact Registry.</p>
<p>Click on the repository, then click <code>Setup Instructions</code> where a tab will appear with a command similar to the below</p>
<pre><code>gcloud auth configure-docker europe-west2-docker.pkg.dev
</code></pre>
<p>Once this is run, you are able to pull images.</p>
<h3 id="official-images">Official images</h3>
<pre><code>podman pull europe-west2-docker.pkg.dev/breadnet-containers/breadnet-cache/alpine
</code></pre>
<h3 id="user-created-images">User created images</h3>
<pre><code>podman pull europe-west2-docker.pkg.dev/breadnet-containers/breadnet-cache/squidfunk/mkdocs-material
</code></pre>
<p>If we have a docker file like the below, we would simply append <code>europe-west2-docker.pkg.dev/breadnet-containers/breadnet-cache/</code> to the image name, and it will use the cache</p>
<pre><code>FROM europe-west2-docker.pkg.dev/breadnet-containers/breadnet-cache/alpine:3.18.2

LABEL org.opencontainers.image.title=&quot;Kubectl&quot;
LABEL org.opencontainers.image.description=&quot;A Docker image for Kubectl&quot;
LABEL org.opencontainers.image.authors=&quot;Bradley Stannard &lt;opensource@breadnet.co.uk&gt;&quot;

RUN apk add curl

RUN curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot;

RUN rm -rf /var/cache/apk/*


RUN install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl

RUN rm /kubectl

ENTRYPOINT [&quot;kubectl&quot;]
</code></pre>
<hr>
<p>As always, if you have any questions please reach out to me!</p>

                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed"><article class="post-card post


 ">

        
            <a class="post-card-image-link" href="http://localhost:1313/post/docker-its-over-moving-to-podman/">
                <img class="post-card-image"src="https://images.unsplash.com/photo-1633967920376-33b2d94f091f?q=80&amp;w=1740&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.1.0&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Docker it&#39;s over, moving to podman"/>
            </a>
        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="http://localhost:1313/post/docker-its-over-moving-to-podman/">
    
                <header class="post-card-header">
                    

                    <h2 class="post-card-title">Docker it&#39;s over, moving to podman</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>Docker, we&rsquo;re breaking up! Tips on moving to podman</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip"></div>
                            <a href="#" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span></span>
                        <span class="post-card-byline-date"><time datetime="2023-114-04">19 April 2023</time>
                            <span class="bull">&bull;</span> 5 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    

            <article class="post-card post
 no-image
 ">

        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="http://localhost:1313/post/dependabot-for-terraform-and-terraform-modules/">
    
                <header class="post-card-header">
                    

                    <h2 class="post-card-title">Dependabot for terraform and terraform modules</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>Looking at using Dependabot to manage your terraform modules and providers? I&rsquo;ve got you covered</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip"></div>
                            <a href="#" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span></span>
                        <span class="post-card-byline-date"><time datetime="2023-17-07">16 July 2023</time>
                            <span class="bull">&bull;</span> 3 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="http://localhost:1313/">breadNET</a> &copy; 2023</section>
                <nav class="site-footer-nav">
                    <a href="http://localhost:1313/">Latest Posts</a>
                    
                    
                    
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3 by Jonathan Janssens</a>
                </nav>
            </div>
        </footer>

    </div>

<script src="http://localhost:1313/js/sticky-nav-title.min.7c74baa114d72c67b1f5c85f55da35fa76c686efef35103f409f57f6bf3f9057.js" integrity="sha256-fHS6oRTXLGex9chfVdo1&#43;nbGhu/vNRA/QJ9X9r8/kFc="></script>
<script>

    
    
    
    
    $(document).ready(function () {

        var nav = document.querySelector('.site-nav-main .site-nav');
        var feed = document.querySelector('.post-feed');

        var lastScrollY = window.scrollY;
        var lastWindowHeight = window.innerHeight;
        var lastDocumentHeight = $(document).height();
        var ticking = false;

        function onScroll() {
            lastScrollY = window.scrollY;
            requestTick();
        }

        function onResize() {
            lastWindowHeight = window.innerHeight;
            lastDocumentHeight = $(document).height();
            requestTick();
        }

        function requestTick() {
            if (!ticking) {
                requestAnimationFrame(update);
            }
            ticking = true;
        }

        function update() {
            var trigger = feed.getBoundingClientRect().top + window.scrollY;
            var progressMax = lastDocumentHeight - lastWindowHeight;

            
            if (lastScrollY >= trigger - 20) {
                nav.classList.add('fixed-nav-active');
            } else {
                nav.classList.remove('fixed-nav-active');
            }

            ticking = false;
        }

        window.addEventListener('scroll', onScroll, { passive: true });
        window.addEventListener('resize', onResize, false);

        update();

    });
</script>
</body>
</html>